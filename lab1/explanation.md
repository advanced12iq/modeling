# explanation.md

## Постановка задачи
Нужно сравнить две модели движения тела, брошенного из точки `(x0, y0) = (0, 0)` при новых параметрах:
- материал шарика: **медь**;
- `alpha = 57°`;
- `v0 = 160 м/с`;
- `r = 0.25 м`;
- `g = 9.81 м/с^2`.

Модель 1: модель Галилея без сопротивления воздуха.  
Модель 2: модель Ньютона с квадратичным сопротивлением воздуха, решаемая методом Рунге-Кутты 4-го порядка (RK4).

## 1. Модель Галилея (без сопротивления)
Используем обозначения `x, y, alpha, v0`.

	x(t) = x0 + v0 * cos(alpha) * t
	y(t) = y0 + v0 * sin(alpha) * t - g * t^2 / 2

Траектория в виде `y(x)`:

`y(x) = - g*x^2 / (2*v0^2*cos^2(alpha)) + tan(alpha)*x + y0`

Точка падения вычисляется из условия `y(t)=0` (берется положительный корень), затем находим `x_land`.

## 2. Модель Ньютона с сопротивлением
Вводим компоненты скорости:
- `u = dx/dt`
- `w = dy/dt`

Система ОДУ:
- `dx/dt = u`
- `dy/dt = w`
- `m * du/dt = - beta * u * sqrt(u^2 + w^2)`
- `m * dw/dt = -m*g - beta * w * sqrt(u^2 + w^2)`

Коэффициент сопротивления:

`beta = c * S * rho_air / 2`

где:
- `c = 0.15`
- `S = 3.0`
- `rho_air = 1.225 кг/м^3`

Начальные скорости:
- `u0 = v0 * cos(alpha)`
- `w0 = v0 * sin(alpha)`

## 3. Масса медного шарика
Радиус задан напрямую: `r = 0.25 м`.

Плотность меди (принятое допущение):
- `rho_copper = 8960 кг/м^3`.

Тогда:
- `V = 4/3 * pi * r^3`
- `m = rho_copper * V`

Для текущих данных: `m = 586.430629 кг`.

## 4. Численное решение RK4
Система по состоянию `state = (x, y, u, w)` интегрируется шагом `dt = 1e-3`:
- `k1 = f(s_n)`
- `k2 = f(s_n + dt/2 * k1)`
- `k3 = f(s_n + dt/2 * k2)`
- `k4 = f(s_n + dt * k3)`
- `s_(n+1) = s_n + dt/6 * (k1 + 2k2 + 2k3 + k4)`

Для больших скоростей используется увеличенное ограничение времени:
- `t_max = max(120.0, 2 * t_land_galileo)`.

## 5. Точная точка падения
В численной модели приземление обычно попадает между шагами (`y_prev > 0`, `y_curr <= 0`).
Применяется линейная интерполяция:
- `frac = y_prev / (y_prev - y_curr)`
- `t_land = t_prev + frac * (t_curr - t_prev)`
- `x_land = x_prev + frac * (x_curr - x_prev)`

Это даёт точное `x` в момент `y=0`.

## 6. Связь теории с кодом
- `galileo_landing(...)` — аналитика для модели Галилея.
- `newton_rhs(...)` — правая часть системы Ньютона.
- `rk4_step(...)` — один шаг RK4.
- `simulate_newton_rk4(...)` — интегрирование до падения + интерполяция.
- `build_comparison(...)` — таблица метрик.
- `save_plot(...)` — сохранение графика траекторий.

## 7. Полученные результаты (новые входные данные)
Для `alpha=57°`, `v0=160 м/с`, `r=0.25 м`, материал медь:
- Галилей: `x_land = 2383.971836 м`, `t_land = 27.357246 с`, `y_max = 917.747757 м`.
- Ньютон + сопротивление: `x_land = 1253.623389 м`, `t_land = 22.331246 с`, `y_max = 614.885546 м`.
- Разница дальности: `delta_x = -1130.348448 м`.

## 8. Интерпретация различий
Сопротивление воздуха уменьшает горизонтальную и вертикальную компоненты скорости. Поэтому в модели Ньютона:
- дальность полета меньше;
- время полета меньше;
- максимальная высота ниже.

Для больших начальных скоростей эффект сопротивления становится особенно заметным, что и видно по разнице более 1 км по дальности.

## 9. Артефакты
- `solution.py` — исполняемый скрипт.
- `solution.ipynb` — эквивалентный ноутбук.
- `comparison.csv` — таблица сравнения.
- `trajectory_comparison.png` — график траекторий.
- `validation_report.md` — независимая проверка требований.
