# explanation.md

## Постановка задачи
Нужно сравнить две модели движения тела, брошенного из точки `(x0, y0) = (0, 0)` с параметрами:
- `alpha = 45°`
- `v0 = 1 м/с`
- `g = 9.81 м/с^2`

Модель 1: классическая модель Галилея (без сопротивления воздуха).  
Модель 2: модель Ньютона с квадратичным сопротивлением воздуха, решаемая численно методом Рунге-Кутты 4-го порядка.

## 1. Модель Галилея (без сопротивления)
Обозначения как на фото: `x, y, v0, alpha`.

Для движения без сопротивления:
- `x(t) = x0 + v0 * cos(alpha) * t`
- `y(t) = y0 + v0 * sin(alpha) * t - g * t^2 / 2`

После исключения времени получаем траекторию:

`y(x) = - g * x^2 / (2 * v0^2 * cos^2(alpha)) + tg(alpha) * x + y0`

Точка падения находится из уравнения `y(t)=0` (берется положительный корень).

## 2. Модель Ньютона с сопротивлением
Используются скорости по осям:
- `u = dx/dt`
- `w = dy/dt`

Система ОДУ:
- `m * du/dt = - beta * u * sqrt(u^2 + w^2)`
- `m * dw/dt = - m*g - beta * w * sqrt(u^2 + w^2)`
- `dx/dt = u`
- `dy/dt = w`

Коэффициент сопротивления:

`beta = c * S * rho / 2`

Параметры:
- `c = 0.15`
- `S = 3`
- `rho = 1.225 кг/м^3` (нормальные условия)

Начальные скорости:
- `u0 = v0 * cos(alpha)`
- `w0 = v0 * sin(alpha)`

## 3. Масса чугунного шарика
По принятому допущению:
- плотность чугуна `rho_cast_iron = 7200 кг/м^3`
- радиус шарика `r = 0.01 м`

Тогда:
- `V = 4/3 * pi * r^3`
- `m = rho_cast_iron * V`

## 4. Численное решение RK4
Для системы `(x, y, u, w)` применяется шаг RK4:
- `k1 = f(s_n)`
- `k2 = f(s_n + dt/2 * k1)`
- `k3 = f(s_n + dt/2 * k2)`
- `k4 = f(s_n + dt * k3)`
- `s_{n+1} = s_n + dt/6 * (k1 + 2k2 + 2k3 + k4)`

Используется `dt = 1e-3`, `t_max = 10`.

## 5. Точное определение точки падения
В численной модели момент падения обычно попадает между двумя шагами сетки (`y_prev > 0`, `y_curr <= 0`).
Чтобы получить точнее `x_land`, используется линейная интерполяция:
- `frac = y_prev / (y_prev - y_curr)`
- `t_land = t_prev + frac * (t_curr - t_prev)`
- `x_land = x_prev + frac * (x_curr - x_prev)`

## 6. Связь теории с кодом
- `galileo_landing(...)` — аналитическая модель Галилея, время падения, дальность, высота, траектория.
- `newton_rhs(...)` — правая часть системы ОДУ Ньютона.
- `rk4_step(...)` — один шаг метода Рунге-Кутты 4-го порядка.
- `simulate_newton_rk4(...)` — полная численная интеграция до падения + интерполяция.
- `build_comparison(...)` — формирование таблицы сравнения метрик.
- `save_plot(...)` — построение и сохранение графика траекторий.

## 7. Полученные результаты (базовый кейс)
Для `alpha=45°`, `v0=1 м/с`, `(0,0)`:
- Галилей: `x_land = 0.101937 м`, `t_land = 0.144160 с`, `y_max = 0.025484 м`
- Ньютон + сопротивление: `x_land = 0.061637 м`, `t_land = 0.123878 с`, `y_max = 0.018945 м`
- Разница дальности: `delta_x = -0.040300 м`

## 8. Интерпретация
С сопротивлением воздуха тело:
- летит меньше по времени;
- достигает меньшей высоты;
- падает ближе к началу координат.

Это ожидаемо, так как сила сопротивления направлена против скорости и отбирает кинетическую энергию.

## 9. Артефакты
- `solution.py` — исполняемый скрипт.
- `solution.ipynb` — эквивалентный ноутбук.
- `trajectory_comparison.png` — график траекторий.
- `comparison.csv` — таблица метрик.
